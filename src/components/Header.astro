---
const { lang = "en" } = Astro.props;
import { t } from "../i18n";
---

<!-- <nav class="flex justify-between items-center p-4 bg-gray-800">
    <a href="/">Pray-Time</a>
    <ul class="flex gap-4">
        <li><a href="#features" class="hover:text-blue">{t(lang, 'header.features')}</a></li>
        <li><a href="#about" class="hover:text-blue">{t(lang, 'header.about')}</a></li>
        <li><a href="#contact" class="hover:text-bluelight">{t(lang, 'header.contact')}</a></li>
    </ul>
</nav> -->
<header class="text-[#94A3B8] items-center">
  <div class="container mx-auto flex p-5 items-center">
    <!-- Logo -->
    <a class="flex title-font font-medium items-center text-white mb-4 md:mb-0">
      <img src="src/assets/images/logo-image.png" alt="Logo" class="w-10 h-10 object-contain"/>
      <!-- <svg
        xmlns="http://www.w3.org/2000/svg"
        fill="none"
        stroke="currentColor"
        stroke-linecap="round"
        stroke-linejoin="round"
        stroke-width="2"
        class="w-10 h-10 text-white p-2 bg-indigo-500 rounded-full"
        viewBox="0 0 24 24"
      >
        <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"
        ></path>
      </svg> -->
      <span class="ml-3 text-xl">PrayTime</span>
    </a>

    <!-- Botón hamburguesa -->
    <button id="menu-toggle" class="ml-auto md:hidden">
      <svg
        class="w-6 h-6"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        viewBox="0 0 24 24"
      >
        <path d="M3 5h18M3 12h18M3 19h18"></path>
      </svg>
    </button>

    <!-- Menú desktop -->
    <nav class="hidden md:ml-auto md:mr-auto space-x-5 md:flex">
      <a class="mr-5 hover:text-white font-medium">Características</a>
      <a class="mr-5 hover:text-white font-medium">Acerca de</a>
      <a class="mr-5 hover:text-white font-medium">Descargar</a>
    </nav>
    <!-- <nav class="hidden md:flex md:ml-auto space-x-5">
            <a href="#">First</a>
            <a href="#">Second</a>
            <a href="#">Third</a>
        </nav> -->

    <div class="flex items-center gap-3">
      <div
        style="width: 2px; height: 30px; border: 1.5px solid #1E293B; border-radius: 100px;"
      >
      </div>
      <div class="relative" data-current-lang={lang}>
        <!-- Accessible custom language selector -->
        <button
          id="language-button"
          type="button"
          aria-haspopup="listbox"
          aria-expanded="false"
          class="flex items-center gap-2 bg-transparent px-2 py-1 rounded hover:bg-white/10"
        >
          <img
            id="language-button-img"
            src={`/src/assets/images/icons/${lang}.svg`}
            alt="Language"
            class="w-5 h-5"
          />
          <span id="language-button-label" class="text-md font-medium"
            >{lang === "es" ? "Español" : "English"}</span
          >
          <svg
            class="w-4 h-4 ml-2"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            viewBox="0 0 24 24"
            ><path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M19 9l-7 7-7-7"></path></svg
          >
        </button>

        <ul
          id="language-list"
          role="listbox"
          aria-label="Languages"
          class="absolute right-0 mt-2 bg-white text-black rounded shadow-md w-20 z-50"
        >
          <li>
            <button
              type="button"
              data-lang="en"
              class="w-full flex items-center gap-2 px-3 py-2 hover:bg-gray-100"
            >
              <!-- <img src="src/assets/images/icons/en.svg" alt="English" class="w-5 h-5" /> -->
              <span>English</span>
            </button>
          </li>
          <li>
            <button
              type="button"
              data-lang="es"
              class="w-full flex items-center gap-2 px-3 py-2 hover:bg-gray-100"
            >
              <!-- <img src="src/assets/images/icons/es.svg" alt="Español" class="w-5 h-5" /> -->
              <span>Español</span>
            </button>
          </li>
        </ul>

        <!-- Hidden native select for forms / accessibility fallback -->
        <select
          name="language"
          id="language-input"
          class="sr-only"
          aria-hidden="true"
        >
          <option value=""></option>
          <option value="en">En</option>
          <option value="es">Es</option>
        </select>
      </div>
      <div
        style="width: 2px; height: 30px; border: 1.5px solid #1E293B; border-radius: 100px;"
      >
      </div>
      <div class="hidden md:flex items-center gap-3">
        <img class="w-3"
          src="src/assets/images/icons/facebook_icon.svg"
          alt="Facebook Icon"
        />
        <img class="w-5"
          src="src/assets/images/icons/instagram_icon.svg"
          alt="Instagram Icon"
        />
        <img class="w-5" src="src/assets/images/icons/tiktok_icon.svg" alt="TikTok Icon" />
      </div>
    </div>
  </div>

  <!-- Menú mobile -->
  <nav
    id="mobile-menu"
    class="hidden md:hidden flex flex-col p-4 space-y-3 bg-gray-900"
  >
    <a class="mr-5 hover:text-white font-medium">Características</a>
      <a class="mr-5 hover:text-white font-medium">Acerca de</a>
      <a class="mr-5 hover:text-white font-medium">Descargar</a>
  </nav>
</header>

<script is:inline>
  const toggle = document.getElementById("menu-toggle");
  const menu = document.getElementById("mobile-menu");

  toggle?.addEventListener("click", () => {
    menu.classList.toggle("hidden");
  });

  // Language selector logic
  (function () {
    const wrapper = document.querySelector("[data-current-lang]");
    if (!wrapper) return;

    const btn = document.getElementById("language-button");
    const btnImg = document.getElementById("language-button-img");
    const btnLabel = document.getElementById("language-button-label");
    const list = document.getElementById("language-list");
    const hiddenSelect = document.getElementById("language-input");

    const langs = {
      en: { label: "En", img: "src/assets/images/icons/translate_icon.svg" },
      es: { label: "Es", img: "src/assets/images/icons/translate_icon.svg" },
    };

    function setLanguage(l) {
      const info = langs[l] || langs.en;
      btnImg.src = info.img;
      btnImg.alt = info.label;
      btnLabel.textContent = info.label;
      hiddenSelect.value = l;
      localStorage.setItem("lang", l);
      btn.setAttribute("aria-expanded", "false");
      list.classList.add("hidden");
    }

    btn.addEventListener("click", (e) => {
      e.stopPropagation();
      const expanded = btn.getAttribute("aria-expanded") === "true";
      btn.setAttribute("aria-expanded", String(!expanded));
      list.classList.toggle("hidden");
    });

    list.querySelectorAll("button[data-lang]").forEach((b) => {
      b.addEventListener("click", (e) => {
        const l = b.dataset.lang;
        setLanguage(l);
      });
    });

    document.addEventListener("click", (e) => {
      if (!btn.contains(e.target) && !list.contains(e.target)) {
        list.classList.add("hidden");
        btn.setAttribute("aria-expanded", "false");
      }
    });

    document.addEventListener("keydown", (e) => {
      if (e.key === "Escape") {
        list.classList.add("hidden");
        btn.setAttribute("aria-expanded", "false");
      }
    });

    const stored = localStorage.getItem("lang");
    const initial = stored || wrapper.dataset.currentLang || "en";
    setLanguage(initial);
  })();
</script>
